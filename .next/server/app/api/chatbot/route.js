"use strict";(()=>{var e={};e.id=145,e.ids=[145],e.modules={54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},77643:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>f,patchFetch:()=>y,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var s={};r.r(s),r.d(s,{POST:()=>l,dynamic:()=>u,runtime:()=>p});var o=r(54631),n=r(52385),a=r(83205),i=r(66525);let p="nodejs",u="force-dynamic";async function l(e){let t=process.env.GEMINI_API_KEY;if(!t)return i.NextResponse.json({message:"GEMINI_API_KEY is not configured"},{status:500});try{let{message:r,history:s=[]}=await e.json();if(!e.cookies.get("token")?.value)return i.NextResponse.json({message:"Unauthorized"},{status:401});if(!r||"string"!=typeof r)return i.NextResponse.json({message:"Message is required"},{status:400});let o=[...Array.isArray(s)?s.filter(e=>!!e&&("user"===e.role||"model"===e.role)&&"string"==typeof e.content):[],{role:"user",content:r}].map(e=>({role:e.role,parts:[{text:e.content}]})),n=await fetch(`https://generativelanguage.googleapis.com/v1/models/gemini-2.5-flash:generateContent?key=${t}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:o})}),a=await n.json();if(!n.ok){let e="string"==typeof a?.error?.message?a.error.message:"Gemini request failed";return i.NextResponse.json({message:e},{status:n.status})}let p="";if(Array.isArray(a?.candidates))for(let e of a.candidates){if(!e||"object"!=typeof e)continue;let t=(Array.isArray(e?.content?.parts)?e.content.parts:[]).find(e=>"string"==typeof e?.text&&e.text.trim().length>0);if(t?.text){p=t.text.trim();break}}return p||a?.promptFeedback?.blockReason!=="SAFETY"||(p="I am unable to respond to that request because it may violate safety guidelines."),i.NextResponse.json({reply:p||"I am still learning. Please try asking in a different way."})}catch(e){return console.error("Chatbot error",e),i.NextResponse.json({message:"Unable to process your request right now."},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/chatbot/route",pathname:"/api/chatbot",filename:"route",bundlePath:"app/api/chatbot/route"},resolvedPagePath:"/home/aman/Downloads/portray-build-shine-main/app/api/chatbot/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:g}=c,f="/api/chatbot/route";function y(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[751,319],()=>r(77643));module.exports=s})();